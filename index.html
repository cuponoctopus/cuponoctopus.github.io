<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ö°</text></svg>">
  <meta name="google-site-verification" content="ReM8XSA0HXl46_0Ns2Cb-SYeUWrFl0noqPpxJ9-C3WQ" />
  <title>C√≥digo Descuento Octopus Energy</title>
  <meta name="description" content="Obt√©n cr√©dito con el c√≥digo descuento de Octopus Energy. Calcula tu ahorro y compara Octopus 3 y Relax.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="canonical" href="https://octopusdescuento.github.io/">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SPGEJ4QSYM"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-SPGEJ4QSYM');
  </script>

  <style>
    :root{
      --octo-purple:#381E72;
      --octo-pink:#E040FB;
      --text:#1b1b1b;
      --muted:#6b6b6b;
      --bg:#ffffff;
      --card:#ffffff;
      --shadow:0 3px 10px rgba(0,0,0,.08);
      --success:#2e7d32;
      --success-bg:#e8f5e9;
      --calc-bg:#f7f2ff; /* bloque calculadora */
      --calc-bd:#eadcff;
    }
    body{font-family:"Segoe UI",Roboto,Arial,sans-serif;max-width:980px;margin:auto;padding:30px;line-height:1.7;color:var(--text);background:var(--bg)}
    h1{color:var(--octo-purple);text-align:center;margin-bottom:.3em}
    h2,h3{color:var(--octo-purple)}
    a.cta{display:inline-block;background:var(--octo-purple);color:#fff;padding:12px 22px;border-radius:8px;text-decoration:none;font-weight:700;transition:.15s}
    a.cta:hover{background:var(--octo-pink)}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:24px}
    .two{grid-template-columns:repeat(auto-fit,minmax(300px,1fr));align-items:start}
    .card{background:var(--card);border-radius:12px;box-shadow:var(--shadow);padding:20px}
    footer{font-size:.95rem;color:var(--muted);text-align:center;margin-top:36px}

    /* Calculadora plegable */
    .calc-toggle{display:flex;justify-content:center;margin:18px 0}
    .btn{background:var(--octo-purple);color:#fff;border:none;padding:10px 18px;border-radius:8px;cursor:pointer;font-weight:700}
    .btn:hover{background:var(--octo-pink)}
    .calc-wrap{background:var(--calc-bg);border:1px solid var(--calc-bd);border-radius:16px;box-shadow:var(--shadow);overflow:hidden;max-height:0;transition:max-height .45s ease}
    .calc-wrap.open{max-height:3000px} /* grande para asegurar apertura en todos los contenidos */
    .calc-inner{padding:20px}
    .calc-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:16px}
    label{font-weight:600;font-size:.95rem}
    input{width:100%;padding:10px 12px;border:1px solid #d7d7d7;border-radius:8px;margin-top:6px;font-size:1rem}
    .center{text-align:center}
    .result{background:#fff;margin-top:16px;padding:16px;border-radius:10px;box-shadow:var(--shadow)}
    .good{color:var(--success)}
    .bad{color:#c62828}
    .pill{display:inline-block;background:var(--success-bg);color:var(--success);padding:2px 10px;border-radius:999px;font-weight:700;font-size:.85rem;margin-left:8px;vertical-align:middle}
  </style>
</head>

<body>
  <h1 id="titulo">‚ö° C√≥digo descuento Octopus Energy (Espa√±a)</h1>
  <p class="center">Con mi enlace de invitaci√≥n, ambos recibimos cr√©dito en factura üíú</p>

  <div class="grid two">
    <div class="card">
      <h2>üí° C√≥mo funciona el c√≥digo</h2>
      <ol>
        <li>Haz clic en el enlace de invitaci√≥n.</li>
        <li>Elige tu tarifa y completa el alta online.</li>
        <li>Cuando el cambio sea efectivo, se aplica el cr√©dito autom√°ticamente.</li>
      </ol>
      <!-- CTA dentro de 'C√≥mo funciona' -->
      <p class ="center"><a id="enlaceRef" target="_blank" href="https://share.octopusenergy.es/dismal-omelet-766" class="cta cta-magenta" rel="noopener noreferrer nofollow sponsored">Usar c√≥digo de Octopus</a></p>
    </div>
    <div class="card">
      <h2>üåø Ventajas de Octopus Energy</h2>
      <ul>
        <li>Energ√≠a 100% renovable certificada.</li>
        <li>Atenci√≥n al cliente excelente y sin permanencia.</li>
        <li>Tarifas transparentes (fija o indexada).</li>
        <li>Cr√©dito directo en factura gracias al programa de referidos.</li>
      </ul>
    </div>
  </div>

  <h2>üìä Calculadora de ahorro</h2>
  <div class="calc-toggle">
    <button id="btnMostrar" class="btn" aria-expanded="false">üí° Calcular mi ahorro</button>
  </div>

  <div id="calcWrap" class="calc-wrap" aria-hidden="true">
    <div class="calc-inner">
      <form id="calc" class="calc-grid">
        <div><label>D√≠as del periodo</label><input type="number" id="dias" value="30" min="1"></div>
        <div><label>Potencia Punta (kW)</label><input type="number" id="pot_p1" step="0.01"></div>
        <div><label>Potencia Valle (kW)</label><input type="number" id="pot_p2" step="0.01"></div>
        <div><label>Consumo Punta (kWh)</label><input type="number" id="kwh_p" step="0.1"></div>
        <div><label>Consumo Llano (kWh)</label><input type="number" id="kwh_l" step="0.1"></div>
        <div><label>Consumo Valle (kWh)</label><input type="number" id="kwh_v" step="0.1"></div>
        <div><label>Lo que pagas ahora (‚Ç¨ / mes)</label><input type="number" id="actual" step="0.01"></div>
      </form>
      <div class="center" style="margin-top:8px">
        <button id="btnCalcular" class="btn">Calcular ahorro</button>
      </div>
      <div id="resultado" class="result" style="display:none;"></div>
    </div>
  </div>

  <div class="card">
    <h2>üí¨ Mi experiencia con Octopus Energy</h2>
    <p>Me cambi√© recientemente y el proceso fue r√°pido y claro. En pocos d√≠as ten√≠a activada la luz, sin cortes ni papeleo. Adem√°s, el cr√©dito por referido apareci√≥ en mi cuenta en la primera factura. Recomiendo usar el enlace porque ambos salimos ganando.</p>
  </div>

  <div class="card">
    <h2>‚ùì Preguntas frecuentes</h2>
    <details>
      <summary>¬øQu√© necesito para hacer el cambio?</summary>
      <p>Tus datos personales y el n√∫mero CUPS de tu suministro, una direcci√≥n de email donde mandarte todas las comunicaciones y facturas, y tu n√∫mero de cuenta bancaria.</p>
    </details>
    <details>
      <summary>¬øD√≥nde encuentro el c√≥digo CUPS?</summary>
      <p>Lo encontrar√°s en cualquier factura de tu suministro, no importa que no sea reciente ya que es un n√∫mero que nunca cambia. Algo parecido a esto: ES1234567891234567XX</p>
    </details>
    <details>
      <summary>¬øCaduca el cr√©dito?</summary>
      <p>¬°Nunca! Te iremos descontando el cr√©dito del total de tus facturas y, todo lo que no hayas utilizado a√∫n, se te seguir√° guardando. Sin caducidad.</p>
    </details>

  </div>

  <footer>
    <p>Divulgaci√≥n: este enlace es de referido, por lo que ambos recibimos cr√©dito en factura.<br><span id="fecha"></span></p>
  </footer>

  <script>
    // Cargar config.json (mes/a√±o + precios + referido)
    let cfg={};
    fetch('config.json')
      .then(r=>r.json())
      .then(data=>{
        cfg=data;
        const titulo=`C√≥digo descuento Octopus Energy (Espa√±a) ‚Äî ${cfg.mes.charAt(0).toUpperCase()+cfg.mes.slice(1)} ${cfg.ano}`;
        document.title=titulo;
        document.getElementById('titulo').textContent=titulo;
        document.getElementById('enlaceRef').href=cfg.referido;
        document.getElementById('fecha').textContent=`Actualizado: ${cfg.mes} ${cfg.ano}`;
      });

    // Plegable calculadora
    const wrap=document.getElementById('calcWrap');
    const btnMostrar=document.getElementById('btnMostrar');
    btnMostrar.addEventListener('click',()=>{
      const willOpen = !wrap.classList.contains('open');
      wrap.classList.toggle('open');
      wrap.setAttribute('aria-hidden', willOpen ? 'false' : 'true');
      btnMostrar.setAttribute('aria-expanded', willOpen ? 'true' : 'false');
      btnMostrar.textContent = willOpen ? '‚ùå Cerrar calculadora' : 'üí° Calcular mi ahorro';
      if(willOpen){ wrap.scrollIntoView({behavior:'smooth', block:'start'}); }
    });

    // C√°lculo + recomendaci√≥n (pill)
    function calcular(){
      const val=id=>Number(document.getElementById(id).value)||0;
      const dias=val('dias'), potP1=val('pot_p1'), potP2=val('pot_p2'),
            kP=val('kwh_p'), kL=val('kwh_l'), kV=val('kwh_v'), actual=val('actual');

      if(!cfg.tarifas){ alert('Esperando datos del archivo config.json'); return; }
      const t=cfg.tarifas;

      const base3=((t.octopus_3.potencia_p1*potP1 + t.octopus_3.potencia_p2*potP2)*dias)
                 +(t.octopus_3.energia_punta*kP + t.octopus_3.energia_llano*kL + t.octopus_3.energia_valle*kV);
      const baseR=((t.relax.potencia_p1*potP1 + t.relax.potencia_p2*potP2)*dias)
                 +((kP+kL+kV)*t.relax.energia);

      const addTaxes = base => {
        const imp = base * cfg.impuesto_electrico;
        const cont = cfg.alquiler_dia * dias;
        return (base + imp + cont) * (1 + cfg.iva);
      };

      const total3 = addTaxes(base3);
      const totalR = addTaxes(baseR);

      const dif3 = total3 - actual;
      const difR = totalR - actual;
      const pct3 = actual ? (dif3/actual*100).toFixed(1) : '0.0';
      const pctR = actual ? (difR/actual*100).toFixed(1) : '0.0';

      // m√°s barata entre Octopus 3 y Relax
      const cheaper = total3 <= totalR ? 'o3' : 'rel';
      const cheaperVal = cheaper==='o3' ? total3 : totalR;

      // Solo mostrar "Opci√≥n m√°s barata" si esa opci√≥n es m√°s barata que la factura actual (si actual > 0)
      const showPill = actual>0 ? (cheaperVal < actual) : true;
      const pill = showPill ? '<span class="pill">Opci√≥n m√°s barata</span>' : '';

      const r=document.getElementById('resultado');
      r.style.display='block';
      r.innerHTML = `
        <h3>Resultados</h3>
        <p>üí° Tu factura actual: <strong>${actual.toFixed(2)} ‚Ç¨</strong></p>
        <p>‚ö° Octopus 3: <strong>${total3.toFixed(2)} ‚Ç¨</strong>
           ${cheaper==='o3' ? pill : ''}
           <span class="${dif3<0?'good':'bad'}">(${dif3<0?'ahorras':'pagas'} ${Math.abs(dif3).toFixed(2)} ‚Ç¨ / ${Math.abs(pct3)}%)</span>
        </p>
        <p>üåø Octopus Relax: <strong>${totalR.toFixed(2)} ‚Ç¨</strong>
           ${cheaper==='rel' ? pill : ''}
           <span class="${difR<0?'good':'bad'}">(${difR<0?'ahorras':'pagas'} ${Math.abs(difR).toFixed(2)} ‚Ç¨ / ${Math.abs(pctR)}%)</span>
        </p>`;
    }
    document.getElementById('btnCalcular').addEventListener('click', calcular);
  </script>
</body>
</html>
